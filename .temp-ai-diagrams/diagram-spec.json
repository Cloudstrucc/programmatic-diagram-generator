{
  "name": "aws_serverless_architecture",
  "title": "AWS Enterprise Serverless Architecture",
  "description": "Comprehensive serverless architecture showing API layer with CloudFront and WAF, Lambda compute with Step Functions orchestration, DynamoDB and caching layer, complete security with IAM/KMS/Cognito, event-driven components, and full observability stack",
  "python_code": "from diagrams import Diagram, Cluster, Edge\nfrom diagrams.aws.compute import Lambda\nfrom diagrams.aws.database import Dynamodb, ElastiCache\nfrom diagrams.aws.network import CloudFront, APIGateway\nfrom diagrams.aws.storage import S3\nfrom diagrams.aws.security import IAM, Cognito, KMS, SecretsManager, WAF\nfrom diagrams.aws.integration import SQS, SNS, Eventbridge, StepFunctions\nfrom diagrams.aws.management import Cloudwatch, Cloudtrail\nfrom diagrams.aws.devtools import Codepipeline\nfrom diagrams.aws.general import Users\n\ngraph_attr = {\n    \"fontsize\": \"24\",\n    \"bgcolor\": \"white\",\n    \"pad\": \"0.6\",\n    \"splines\": \"ortho\",\n    \"nodesep\": \"0.7\",\n    \"ranksep\": \"0.9\",\n}\n\nwith Diagram(\n    \"AWS Enterprise Serverless Architecture\",\n    filename=\"OUTPUT_PATH\",\n    outformat=\"png\",\n    show=False,\n    direction=\"LR\",\n    graph_attr=graph_attr\n):\n    # Users\n    users = Users(\"End Users\nWeb/Mobile\nAPI Clients\")\n    \n    # API Layer\n    with Cluster(\"API Layer\", graph_attr={\"bgcolor\": \"#e8f5e9\"}):\n        cdn = CloudFront(\"CloudFront CDN\nGlobal Edge\nCaching\")\n        waf = WAF(\"WAF\nOWASP Rules\nRate Limiting\")\n        api = APIGateway(\"API Gateway\nREST/HTTP\nThrottling\")\n        \n        cdn >> Edge(label=\"Protected\nTraffic\", color=\"red\", style=\"bold\") >> waf\n        waf >> Edge(label=\"Filtered\nRequests\", color=\"blue\") >> api\n    \n    # Identity & Security\n    with Cluster(\"Identity & Access\", graph_attr={\"bgcolor\": \"#e3f2fd\"}):\n        cognito = Cognito(\"Cognito\nUser Pools\nJWT Tokens\")\n        iam = IAM(\"IAM Roles\nLeast Privilege\nAssumeRole\")\n        \n        api >> Edge(label=\"Auth\nValidation\", color=\"purple\", style=\"dashed\") >> cognito\n    \n    # Compute Layer\n    with Cluster(\"Compute Layer\", graph_attr={\"bgcolor\": \"#fff3e0\"}):\n        with Cluster(\"Lambda Functions\"):\n            auth_lambda = Lambda(\"Auth Service\nToken Validation\nUser Context\")\n            api_lambda = Lambda(\"API Service\nBusiness Logic\nValidation\")\n            data_lambda = Lambda(\"Data Service\nCRUD Ops\nTransforms\")\n            async_lambda = Lambda(\"Async Service\nBackground\nProcessing\")\n        \n        step_fn = StepFunctions(\"Step Functions\nWorkflow\nOrchestration\")\n        \n        api >> Edge(label=\"Invoke\nSynchronous\", color=\"blue\") >> auth_lambda\n        auth_lambda >> Edge(label=\"Authorized\nRequest\", color=\"green\") >> api_lambda\n        api_lambda >> Edge(label=\"Data\nOperations\", color=\"blue\") >> data_lambda\n        api_lambda >> Edge(label=\"Orchestrate\nWorkflow\", color=\"orange\", style=\"dashed\") >> step_fn\n        step_fn >> Edge(label=\"Execute\nSteps\", color=\"orange\", style=\"dashed\") >> async_lambda\n    \n    # Security Layer\n    with Cluster(\"Security & Encryption\", graph_attr={\"bgcolor\": \"#ffebee\"}):\n        with Cluster(\"Key Hierarchy\"):\n            kms_root = KMS(\"KMS CMK\nRoot Key\nAuto-rotation\")\n            kms_data = KMS(\"Data Key\nDynamoDB\nEncryption\")\n            kms_s3 = KMS(\"S3 Key\nObject\nEncryption\")\n        \n        secrets = SecretsManager(\"Secrets Manager\nAPI Keys\nDB Credentials\")\n        \n        kms_root >> Edge(label=\"Wrap\nData Keys\", color=\"red\", style=\"bold\") >> kms_data\n        kms_root >> Edge(label=\"Wrap\nS3 Keys\", color=\"red\", style=\"bold\") >> kms_s3\n        \n        iam >> Edge(label=\"kms:Decrypt\nkms:GenerateDataKey\", color=\"purple\", style=\"dashed\") >> kms_root\n        auth_lambda >> Edge(label=\"Retrieve\nSecrets\", color=\"red\", style=\"bold\") >> secrets\n    \n    # Data Layer\n    with Cluster(\"Data Layer\", graph_attr={\"bgcolor\": \"#e0f7fa\"}):\n        dynamodb = Dynamodb(\"DynamoDB\nNoSQL\nAuto-scaling\")\n        cache = ElastiCache(\"ElastiCache\nRedis\nSession Cache\")\n        s3 = S3(\"S3 Bucket\nObjects\nStatic Assets\")\n        \n        data_lambda >> Edge(label=\"Read/Write\nEncrypted\", color=\"blue\") >> dynamodb\n        data_lambda >> Edge(label=\"Cache\nLookup\", color=\"green\") >> cache\n        async_lambda >> Edge(label=\"Store\nObjects\", color=\"blue\") >> s3\n        \n        kms_data >> Edge(label=\"Encrypt\nat Rest\", color=\"red\", style=\"bold\") >> dynamodb\n        kms_s3 >> Edge(label=\"Encrypt\nObjects\", color=\"red\", style=\"bold\") >> s3\n    \n    # Event-Driven Architecture\n    with Cluster(\"Event-Driven Components\", graph_attr={\"bgcolor\": \"#f3e5f5\"}):\n        eventbridge = Eventbridge(\"EventBridge\nEvent Bus\nRules Engine\")\n        sqs = SQS(\"SQS Queue\nFIFO\nDLQ\")\n        sns = SNS(\"SNS Topic\nFan-out\nNotifications\")\n        \n        api_lambda >> Edge(label=\"Publish\nEvents\", color=\"orange\", style=\"dashed\") >> eventbridge\n        eventbridge >> Edge(label=\"Route\nEvents\", color=\"orange\", style=\"dashed\") >> sqs\n        eventbridge >> Edge(label=\"Broadcast\nAlerts\", color=\"orange\", style=\"dashed\") >> sns\n        sqs >> Edge(label=\"Process\nAsync\", color=\"blue\") >> async_lambda\n    \n    # Monitoring & Observability\n    with Cluster(\"Observability Stack\", graph_attr={\"bgcolor\": \"#fff3e0\"}):\n        cloudwatch = Cloudwatch(\"CloudWatch\nLogs/Metrics\nAlarms\")\n        xray = Cloudwatch(\"X-Ray\nDistributed\nTracing\")\n        cloudtrail = Cloudtrail(\"CloudTrail\nAudit Logs\nCompliance\")\n        \n        auth_lambda >> Edge(label=\"Logs\nMetrics\", color=\"gray\", style=\"dotted\") >> cloudwatch\n        api_lambda >> Edge(label=\"Traces\nSegments\", color=\"gray\", style=\"dotted\") >> xray\n        iam >> Edge(label=\"API Calls\nAudit\", color=\"gray\", style=\"dotted\") >> cloudtrail\n    \n    # CI/CD Pipeline\n    with Cluster(\"Automation\", graph_attr={\"bgcolor\": \"#e8f5e9\"}):\n        pipeline = Codepipeline(\"CodePipeline\nCI/CD\nAutomation\")\n        \n        pipeline >> Edge(label=\"Deploy\nFunctions\", color=\"green\") >> auth_lambda\n    \n    # Main flow\n    users >> Edge(label=\"HTTPS\nRequests\", color=\"blue\") >> cdn\n    \n    # RBAC connections\n    cognito >> Edge(label=\"Assume\nRole\", color=\"purple\", style=\"dashed\") >> iam\n    \n    # Monitoring connections\n    cloudwatch >> Edge(label=\"Trigger\nAlerts\", color=\"orange\", style=\"dashed\") >> sns",
  "style": "aws",
  "quality": "enterprise"
}